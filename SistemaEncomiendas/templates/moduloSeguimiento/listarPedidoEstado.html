{% extends "base4.html" %}
{% load tz %}
{% block titulo %}Cambiar Estados{% endblock titulo %}
{% block body %}
<div class="container mt-3">
    <div class=" row bg-secondary py-1">
        <h3 class="mb-1 text-white">Cambiar Estados</h3>
    </div>
    <div class=" row align-items-center border mt-1 " style="background-color: #F5F0EF;">
        <div class="col-md-6  ">
            <div class="d-flex ">
                <p class="mb-1 font-weight-bold">
                    <b><i class="fas fa-search"></i> Buscar registro</b>
                </p>
                
            </div>
        </div>
        <div class="col-md-6  mb-1">
            <div class="d-flex justify-content-end   ">
                <form method="GET" action="{% url 'moduloSeguimiento:cambiar_estado' %}" class="mb-3">
                    <select id="estado" name="estado" class="form-select" onchange="this.form.submit()">
                        <option value="all">Todos los registros</option>
                        <option value="Prealerta" {% if request.GET.estado == "Prealerta" %}selected{% endif %}>Prealerta</option>
                        <option value="Cancelado" {% if request.GET.estado == "Cancelado" %}selected{% endif %}>Cancelado</option>
                        <option value="En Procesamiento" {% if request.GET.estado == "En Procesamiento" %}selected{% endif %}>En Procesamiento</option>
                        <option value="En Espera de Pago" {% if request.GET.estado == "En Espera de Pago" %}selected{% endif %}>En Espera de Pago</option>
                        <option value="Pago Recibido" {% if request.GET.estado == "Pago Recibido" %}selected{% endif %}>Pago Recibido</option>
                        <option value="En Ruta" {% if request.GET.estado == "En Ruta" %}selected{% endif %}>En Ruta</option>
                        <option value="Entregado" {% if request.GET.estado == "Entregado" %}selected{% endif %}>Entregado</option>
                    </select>
                </form>
            </div>
        </div>
    </div>

    <table class="table table-striped table-hover table-bordered mt-5">
        <thead>
            <tr>
                <th class="bg-secondary text-white text-center" scope="col">#</th>
                <th class="bg-secondary text-white  text-center" scope="col">Numero de orden</th>
                <th class="bg-secondary text-white  text-center" scope="col">Nombres Cliente</th>
                <th class="bg-secondary text-white  text-center" scope="col">Punto de entrega</th>
                <th class="bg-secondary text-white  text-center" scope="col">Punto de recepcion</th>
                <th class="bg-secondary text-white  text-center" scope="col">Estado del pedido</th>
                <th class="bg-secondary text-white  text-center" scope="col">Acciones</th>
            </tr>
        </thead>
        <tbody>
            {% for pedido in lista_pedidos_estado %}
            <tr>
                <td class="text-center" style="min-height: 50px;">{{pedido.id_pedido}}</td>
                <td class="text-center" style="min-height: 50px;">{{pedido.numero_orden}} </td>
                <td class="text-center" style="min-height: 50px;">{{pedido.id_cliente.nombreCliente}} </td>
                <td class="text-center" style="min-height: 50px;">
                    <span title="{{pedido.punto_entrega}}">{{ pedido.punto_entrega|truncatechars:20 }}</span>
                </td>
                <td class="text-center" style="min-height: 50px;">
                    <span title="{{pedido.punto_recepcion}}">{{pedido.punto_recepcion|truncatechars:20 }} </span>
                </td>
                <td class="text-center">
                    {% if pedido.estado_pedido == "Prealerta" %}
                        <span class="badge bg-warning text-dark">{{ pedido.estado_pedido }}</span>
                    {% elif pedido.estado_pedido == "Cancelado" %}
                        <span class="badge bg-danger text-white">{{ pedido.estado_pedido }}</span>
                    {% elif pedido.estado_pedido == "En Procesamiento" %}
                        <span class="badge bg-info text-white">{{ pedido.estado_pedido }}</span>
                    {% elif pedido.estado_pedido == "En Espera de Pago" %}
                        <span class="badge bg-secondary text-white">{{ pedido.estado_pedido }}</span>
                    {% elif pedido.estado_pedido == "Pago Recibido" %}
                        <span class="badge bg-primary text-white">{{ pedido.estado_pedido }}</span>
                    {% elif pedido.estado_pedido == "En Ruta" %}
                        <span class="badge bg-warning text-white">{{ pedido.estado_pedido }}</span>
                    {% elif pedido.estado_pedido == "Entregado" %}
                        <span class="badge bg-success text-white">{{ pedido.estado_pedido }}</span>
                    {% else %}
                        <span class="badge bg-light text-dark">{{ pedido.estado_pedido }}</span> <!-- Default case -->
                    {% endif %}
                </td>
                
                

                <td class="d-flex justify-content-center" style="min-height: 50px;">
                    <a href="{% url 'moduloSeguimiento:crear_estado' pedido.id_pedido %} " class="icon-link text-primary mx-auto mb-3 d-flex flex-column position-relative" style="font-size: 20px;">
                        <i class="fas fa-user-edit"></i>
                        <span class="tooltip-text position-absolute top-0 start-50 translate-middle badge bg-dark text-white">Actualizar</span>
                    </a> 
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

{% endblock body %}